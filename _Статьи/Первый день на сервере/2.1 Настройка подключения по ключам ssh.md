```
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è SSH –∫–ª—é—á–µ–π (ed25519 vs RSA)
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ sshd_config (–ø–æ—Ä—Ç, –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ –∫–ª—é—á–∞–º (authorized_keys, –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞)
- –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (~/.ssh/config)
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
 ```

–°—á–∏—Ç–∞–µ—Ç—Å—è —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –≤ —Å–µ—Ç–∏,  –º—ã –ø–æ–¥–∫–ª—é—á–∏–ª–∏—Å—å –Ω–∞ –Ω–µ–≥–æ —á–µ—Ä–µ–∑ —Ç–µ—Ä–º–∏–∞–Ω–ª –ø–æ –ø–∞—Ä–æ–ª—é.  

–¢—É—Ç —Ç–æ–≥–¥–∞ –ª–æ–≥–∏—á–Ω–µ–µ –≠–¢–û–¢ –ë–õ–û–ö –ü–û–°–õ–ï —Å–µ—Ç–µ–≤–æ–≥–æ 

–õ–æ–∫–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞ = –Ω–æ—É—Ç–±—É–∫. 
–£–¥–∞–ª–µ–Ω–Ω–∞—è –º–∞—à–∏–Ω–∞ = —Å–µ—Ä–≤–µ—Ä. 

###  –ì–µ—Ä–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞ –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ 

```sh
# C–≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∫–ª—é—á–∏
ssh-keygen -t ed25519 -C "s3d0y@home-server" -f ~/.ssh/hmsrvadm_key

# –ü—Ä–æ–≤–µ—Ä–∏–º: 
ls -la ~/.ssh/hmsrvadm_key*
```

–ö–æ–ø–∏—Ä—É–µ–º –∫–ª—é—á –≤  ~/.ssh/authorized_keys

``` sh
s3d0y@hmsrv:~$ echo "ssh-ed25519 AAAAC3NzaC1lZDI1N.... 
s3d0y@home-server" >> ~/.ssh/authorized_keys
```

–ï—â–µ –≤–∞—Ä–∏–∞–Ω—Ç –ø–µ—Ä–µ–¥–∞—á–∏ –∫–ª—é—á–µ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä 

```sh 
# –° —É–∫–∞–∑–∞–Ω–∏–µ–º –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä–Ω–æ–≥–æ –ø–æ—Ä—Ç–∞
ssh-copy-id -i ~/.ssh/hmsrvadm_key.pub -p 3322 hmsrvadm@192.168.88.250
# —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π 22 –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π 
```

‚ö†Ô∏è –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ - —Å–∞–º–∞—è —á–∞—Å—Ç–∞—è –ø—Ä–∏—á–∏–Ω–∞ –ø—Ä–æ–±–ª–µ–º —Å SSH-–∫–ª—é—á–∞–º–∏. –ù–µ –∑–∞–±—ã–≤–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å [[–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞]]

```sh 
chmod 700 ~/.ssh 
chmod 600 ~/.ssh/authorized_keys
```

``` sh
drwx------  # .ssh directory (700)
-rw-------  # authorized_keys (600)
-rw-------  # private key (600)
-rw-r--r--  # public key (644)
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ sshd_config –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω–æ–π –º–∞—à–∏–Ω–µ

``` sh 
#Basic Settings
Port 3322
Protocol 2
LogLevel VERBOSE

#Authentication Security
PermitRootLogin no
PasswordAuthentication no
PubkeyAuthentication yes
KbdInteractiveAuthentication no
PermitEmptyPasswords no

#User Restriction
AllowUsers s3d0y hmsrvadm
MaxAuthTries 3
MaxSessions 2
LoginGraceTime 30
MaxStartups 2

#Connection Settings

ClientAliveInterval 300
ClientAliveCountMax 2
X11Forwarding no

#Misc
UsePAM yes
PrintMotd no
PrintLastLog yes

#Subsustem
Subsystem sftp /usr/lib/openssh/sftp-server

```

–ü–æ–¥—Ä–æ–±–Ω–µ–µ

``` sh 
# =============================================
# Basic Settings (–û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)
# =============================================

Port 3322
# ‚ö†Ô∏è  –ú–µ–Ω—è–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–æ—Ä—Ç 22 –Ω–∞ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π
# ‚úÖ –°–Ω–∏–∂–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∞—Ç–∞–∫
# ‚ùå –ù—É–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å –ø–æ—Ä—Ç –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏

Protocol 2
# üîê –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–ª—å–∫–æ –ø—Ä–æ—Ç–æ–∫–æ–ª SSH 2
# ‚úÖ –ë–æ–ª–µ–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π, —É—è–∑–≤–∏–º–æ—Å—Ç–∏ SSH 1 –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
# ‚ùå –°—Ç–∞—Ä—ã–µ –∫–ª–∏–µ–Ω—Ç—ã –Ω–µ —Å–º–æ–≥—É—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è

LogLevel VERBOSE
# üìä –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
# ‚úÖ –ü–æ–º–æ–≥–∞–µ—Ç –≤ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–µ –ø—Ä–æ–±–ª–µ–º
# ‚ùå –ó–∞–Ω–∏–º–∞–µ—Ç –±–æ–ª—å—à–µ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ


# =============================================
# Authentication Security (–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏)
# =============================================

PermitRootLogin no
# üö´ –ó–∞–ø—Ä–µ—â–∞–µ–º –≤—Ö–æ–¥ –ø–æ–¥ root –Ω–∞–ø—Ä—è–º—É—é
# ‚úÖ –£–º–µ–Ω—å—à–∞–µ—Ç —Ä–∏—Å–∫ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏ —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
# üîÑ –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è + sudo

PasswordAuthentication no
# üîê –û—Ç–∫–ª—é—á–∞–µ–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –ø–æ –ø–∞—Ä–æ–ª—è–º
# ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å-–∞—Ç–∞–∫
# ‚ùå –¢—Ä–µ–±—É–µ—Ç –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ SSH-–∫–ª—é—á–µ–π

PubkeyAuthentication yes
# üîë –í–∫–ª—é—á–∞–µ–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –ø–æ –∫–ª—é—á–∞–º
# ‚úÖ –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Å—Ç–æ–π–∫–∏–π –º–µ—Ç–æ–¥
# üìÅ –ö–ª—é—á–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ ~/.ssh/authorized_keys

KbdInteractiveAuthentication no
# üö´ –û—Ç–∫–ª—é—á–∞–µ–º –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é
# ‚úÖ –£–±–∏—Ä–∞–µ—Ç –ª–∏—à–Ω–∏–µ –º–µ—Ç–æ–¥—ã –≤—Ö–æ–¥–∞
# üîß –û–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–º–µ—Å—Ç–µ —Å PAM

PermitEmptyPasswords no
# üö´ –ó–∞–ø—Ä–µ—â–∞–µ–º –ø—É—Å—Ç—ã–µ –ø–∞—Ä–æ–ª–∏
# ‚úÖ –ë–∞–∑–æ–≤–∞—è –º–µ—Ä–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
# ‚ö†Ô∏è  –î–∞–∂–µ –ø—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–Ω—ã—Ö –ø–∞—Ä–æ–ª—è—Ö


# =============================================
# User Restriction (–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
# =============================================

AllowUsers s3d0y hmsrvadm
# üë• –Ø–≤–Ω–æ —Ä–∞–∑—Ä–µ—à–∞–µ–º —Ç–æ–ª—å–∫–æ —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
# ‚úÖ –ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ –∞—Ç–∞–∫–∏
# ‚ùå –ù–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –≤—Ä—É—á–Ω—É—é

MaxAuthTries 3
# üî¢ –ú–∞–∫—Å–∏–º—É–º 3 –ø–æ–ø—ã—Ç–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∑–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
# ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–¥–±–æ—Ä–∞ –ø–∞—Ä–æ–ª–µ–π/–∫–ª—é—á–µ–π
# üîÑ –ü–æ—Å–ª–µ 3 –æ—à–∏–±–æ–∫ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–∞–∑—Ä—ã–≤–∞–µ—Ç—Å—è

MaxSessions 2
# üî¢ –ú–∞–∫—Å–∏–º—É–º 2 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–µ—Å—Å–∏–∏ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
# ‚úÖ –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–∞–º–∏
# üí° –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

LoginGraceTime 30
# ‚è±Ô∏è 30 —Å–µ–∫—É–Ω–¥ –Ω–∞ —É—Å–ø–µ—à–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é
# ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –≤–∏—Å—è—â–∏—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
# üîÑ –ü–æ—Å–ª–µ —Ç–∞–π–º–∞—É—Ç–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–∞–∑—Ä—ã–≤–∞–µ—Ç—Å—è

MaxStartups 2
# üî¢ –ú–∞–∫—Å–∏–º—É–º 2 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –Ω–µ–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
# ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç DDoS-–∞—Ç–∞–∫
# üîß –û—á–µ—Ä–µ–¥—å: 10:30:100 (—Å—Ç–∞–Ω–¥–∞—Ä—Ç) ‚Üí 2 (—Å—Ç—Ä–æ–≥–æ)


# =============================================
# Connection Settings (–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è)
# =============================================

ClientAliveInterval 300
# ‚ù§Ô∏è –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 300 —Å–µ–∫—É–Ω–¥ (5 –º–∏–Ω—É—Ç)
# ‚úÖ –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ "–≤–∏—Å—è—â–∏—Ö" –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
# üîß –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç "keep-alive" –ø–∞–∫–µ—Ç—ã

ClientAliveCountMax 2
# üî¢ –ú–∞–∫—Å–∏–º—É–º 2 –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ç–∞ –Ω–∞ keep-alive
# ‚úÖ –ü–æ—Å–ª–µ 2 –ø—Ä–æ–ø—É—Å–∫–æ–≤ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–∞–∑—Ä—ã–≤–∞–µ—Ç—Å—è
# ‚è±Ô∏è –û–±—â–∏–π —Ç–∞–π–º–∞—É—Ç: 300 √ó 2 = 10 –º–∏–Ω—É—Ç

X11Forwarding no
# üö´ –û—Ç–∫–ª—é—á–∞–µ–º –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ X11
# ‚úÖ –£–º–µ–Ω—å—à–∞–µ—Ç –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å –∞—Ç–∞–∫–∏
# ‚ùå –ù–µ–ª—å–∑—è –∑–∞–ø—É—Å–∫–∞—Ç—å –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è


# =============================================
# Misc (–†–∞–∑–Ω–æ–µ)
# =============================================

UsePAM yes
# üîß –ò—Å–ø–æ–ª—å–∑—É–µ–º Pluggable Authentication Modules
# ‚úÖ –ì–∏–±–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
# üîÑ –ù—É–∂–µ–Ω –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –≤—Ö–æ–¥–∞

PrintMotd no
# üö´ –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å Message of the Day
# ‚úÖ –ß–∏—Å—Ç—ã–π –≤—ã–≤–æ–¥ –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏
# üí° MOTD –º–æ–∂–µ—Ç —Ä–∞—Å–∫—Ä—ã–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–∏—Å—Ç–µ–º–µ

PrintLastLog yes
# üìã –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤—Ö–æ–¥–∞
# ‚úÖ –ü–æ–º–æ–≥–∞–µ—Ç –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø
# üîç "Last login: Mon Dec 1 14:30:21 2023 from ..."


# =============================================
# Subsystem (–ü–æ–¥—Å–∏—Å—Ç–µ–º—ã)
# =============================================

Subsystem sftp /usr/lib/openssh/sftp-server
# üìÅ –í–∫–ª—é—á–∞–µ–º SFTP –ø–æ–¥—Å–∏—Å—Ç–µ–º—É
# ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ —Ñ–∞–π–ª–æ–≤ –ø–æ–≤–µ—Ä—Ö SSH
# üîß –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ FTP —Å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º


```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ ssh_config –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ

```
Host home-server
    HostName 192.168.88.250
    Port 3322
    User s3d0y
    IdentityFile ~/.ssh/s3d0y_key
    IdentitiesOnly yes
    ServerAliveInterval 60
    ServerAliveCountMax 3

Host home-server-admin
    HostName 192.168.88.250
    Port 3322  
    User hmsrvadm
    IdentityFile ~/.ssh/hmsrvadm_key
    IdentitiesOnly yes
    ServerAliveInterval 60
	ServerAliveCountMax 3
```

–≠—Ç–æ –¥–∞—Å—Ç –Ω–∞–º 

- —É–¥–æ–±–Ω—ã–µ –∫–æ—Ä–æ—Ç–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã  ssh home-server
- –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ —á–µ—Ä–µ–∑ TAB. 
- —É–¥–æ–±—Å—Ç–≤–æ [[SFTP]] –∏ [[SCP - –æ—Ç–ø—Ä–∞–≤–∫–∞ –∏ –≤—ã—Ç—è–≥–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤]]

``` sh
# –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
sftp home-server

# –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ 
scp file.txt home-server:/tmp/
scp home-server:/var/log/syslog ./ 
```



### –¢–µ—Å—Ç—ã

 –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –ø–∞—Ä–æ–ª–∏ –û–¢–ö–õ–Æ–ß–ï–ù–´
``` sh
ssh -o PreferredAuthentications=password user@server -p 3322
# –û–∂–∏–¥–∞–µ–º: Permission denied (publickey)
``` 

 


